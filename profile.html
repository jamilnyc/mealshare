<!doctype html>
<html>
<head>
	<title> Preferences </title>
	<link rel="stylesheet" href="html/stylesheet.css">
</head>
<body>
	<div class="nav-bar inline">
		<div id="nav-bar-buffer">
		</div>
		<div class="search-bar">
		</div>
		<div class="logo">
			<h1>mealShare</h1>
		</div>
		<div class="path-icons">
			<img id="home-icon" src="img/home.png" onclick="location.href='home.html'">
			<img id="cal-icon" src="img/cal.png"> 
			<img id="profile-icon" src="img/profile.png"> 
		</div>
	</div>
	<div id="preferences" class="inline">
		<div id="pref-left">
			<div id="home-avail-container">
				<div id="user-info">
					<h1>Name</h1>
					<img id="profile-pic" src="img/notavail.png">
				</div>
				<div id="avatar-container">
					<input id="avatar-file-input" type="file" />
					<button id="avatar-file-upload-button">Upload Avatar</button>
				</div>
			</div>
		</div>
		<div id="pref-right">
			<h3>Weekly Availability</h3>
			<h5 id="availability-month">hello</h5>
			<table id="profile-avail">
				<tr>
					<th id="h-day-1">Sun</th>
					<th id="h-day-2">Mon</th>
					<th id="h-day-3">Tue</th>
					<th id="h-day-4">Wed</th>
					<th id="h-day-5">Thu</th>
					<th id="h-day-6">Fri</th>
					<th id="h-day-7">Sat</th>
				</tr>
					<td id="d-day-1" class="clear"></td>
					<td id="d-day-2" class="clear"></td>
					<td id="d-day-3" class="clear"></td>
					<td id="d-day-4" class="clear"></td>
					<td id="d-day-5" class="clear"></td>
					<td id="d-day-6" class="clear"></td>
					<td id="d-day-7" class="clear"></td>
			</table>
			<div id="favorite-dish">
				<h3>Favorite Dish:</h3>
				<p></p>
				<input type="text">
			</div> 
			<div id="dining-pref">
				<h3>Dining Preference:</h3>
				<p>pick-up</p>
				<select>
					<option id="pick-up" value="pick-up">pick-up</option>
					<option id="drop-off" value="drop-off">drop-off</option>
					<option id="dine-in" value="dine-in">dine-in</option>
				</select>
			</div>
			<div id="dietary-pref">
				<h3>Dietary Preferences</h3>
				<input type="checkbox" disabled="true"> Vegan
				<input type="checkbox" disabled="true"> Vegetarian
				<input type="checkbox" disabled="true"> Kosher
				<input type="checkbox" disabled="true"> Gluten Free
				<h6>Allergies/Other Dietary Restrictions:</h6>
				<p></p>
				<textarea></textarea>
			</div>
		</div>
	</div>
	<br>
	<div id="pref-edit-option-edit">
		<button>Edit</button>
	</div>
	<div id="pref-edit-option-save" class='hidden'>
		<button>Save</button>
	</div>


	<!--Put the HTML structure of the page here -->


    <script src="js/jquery-3.3.1.min.js"></script>

    <!-- Required for API Gateway SDK -->
    <script type="text/javascript" src="js/lib/axios/dist/axios.standalone.js"></script>
    <script type="text/javascript" src="js/lib/CryptoJS/rollups/hmac-sha256.js"></script>
    <script type="text/javascript" src="js/lib/CryptoJS/rollups/sha256.js"></script>
    <script type="text/javascript" src="js/lib/CryptoJS/components/hmac.js"></script>
    <script type="text/javascript" src="js/lib/CryptoJS/components/enc-base64.js"></script>
    <script type="text/javascript" src="js/lib/url-template/url-template.js"></script>
    <script type="text/javascript" src="js/lib/apiGatewayCore/sigV4Client.js"></script>
    <script type="text/javascript" src="js/lib/apiGatewayCore/apiGatewayClient.js"></script>
    <script type="text/javascript" src="js/lib/apiGatewayCore/simpleHttpClient.js"></script>
    <script type="text/javascript" src="js/lib/apiGatewayCore/utils.js"></script>
    <script type="text/javascript" src="js/apigClient.js"></script>
    <script type="text/javascript" src="js/aws-sdk.min.js"></script>
    <script type="text/javascript" src="js/amazon-cognito-identity.min.js"></script>
    
    <script type="text/javascript" src="js/config.js"></script>
    <script type="text/javascript" src="js/main.js"></script>
    <script type="text/javascript" src="js/auth.js"></script>
    <script type="text/javascript" src="js/users.js"></script>
    <script type="text/javascript" src="js/preferences.js"></script>

	<script type="text/javascript">
		$("#pref-edit-option-edit button").on("click", function() {
			jQuery("#avatar-container").show();
			jQuery("#favorite-dish p").hide();
			jQuery("#favorite-dish input").show();
			$("#favorite-dish input").attr('value', $("#favorite-dish p").text());
			jQuery("#dining-pref p").hide();
			jQuery("#dining-pref select").show();
			$("#" + $("#dining-pref p").text() ).attr('selected', 'selected');
			jQuery("#pref-edit-option-edit").hide();
			jQuery("#pref-edit-option-save").show();
			jQuery("#dietary-pref input").attr('disabled', false);
			jQuery("#dietary-pref p").hide();
			jQuery("#dietary-pref textarea").show();
			$("#dietary-pref textarea").attr('value', jQuery("#dietary-pref p").text())
			$("#pref-edit-option-save").attr('class', 'other');
		});

		$("#pref-edit-option-save button").on("click", function() {
			jQuery("#avatar-container").hide();
			jQuery("#favorite-dish p").show();
			jQuery("#favorite-dish input").hide();
			jQuery("#favorite-dish p").text($("#favorite-dish input").val());
			jQuery("#dining-pref p").show();
			jQuery("#dining-pref select").hide();
			jQuery("#dining-pref p").text($("#dining-pref select").val());
			jQuery("#pref-edit-option-edit").show();
			jQuery("#pref-edit-option-save").hide();
			jQuery("#dietary-pref input").attr('disabled', true);
			jQuery("#dietary-pref p").show();
			jQuery("#dietary-pref p").text($("#dietary-pref textarea").val());
			jQuery("#dietary-pref textarea").hide();
			$("#pref-edit-option-save").attr('class', 'hidden');
		})

		jQuery(function (){
			d = new Date();
			jQuery('#availability-month').text(mS[d.getMonth()])	
			for (var i=0; i < daysInWeek.length; i++) {		   
			    var header = '#h-day-'+ (i+1);
			    jQuery(header).text(daysInWeek[0]);
			}
		});

		$("#d-day-1").on("click", function () {
			if ($("#pref-edit-option-save").attr('class') != 'hidden') {
				if ($("#d-day-1").attr('class') == 'clear') {
					$("#d-day-1").attr('class', 'shaded');
				} else {
					$("#d-day-1").attr('class', 'clear');
				}
			}
		});

		$("#d-day-2").on("click", function () {
			if ($("#pref-edit-option-save").attr('class') != 'hidden') {
				if ($("#d-day-2").attr('class') == 'clear') {
					$("#d-day-2").attr('class', 'shaded');
				} else {
					$("#d-day-2").attr('class', 'clear');
				}
			}
		});

		$("#d-day-3").on("click", function () {
			if ($("#pref-edit-option-save").attr('class') != 'hidden') {
				if ($("#d-day-3").attr('class') == 'clear') {
					$("#d-day-3").attr('class', 'shaded');
				} else {
					$("#d-day-3").attr('class', 'clear');
				}
			}
		});

		$("#d-day-4").on("click", function () {
			if ($("#pref-edit-option-save").attr('class') != 'hidden') {
				if ($("#d-day-4").attr('class') == 'clear') {
					$("#d-day-4").attr('class', 'shaded');
				} else {
					$("#d-day-4").attr('class', 'clear');
				}
			}
		});

		$("#d-day-5").on("click", function () {
			if ($("#pref-edit-option-save").attr('class') != 'hidden') {
				if ($("#d-day-5").attr('class') == 'clear') {
					$("#d-day-5").attr('class', 'shaded');
				} else {
					$("#d-day-5").attr('class', 'clear');
				}
			}
		});

		$("#d-day-6").on("click", function () {
			if ($("#pref-edit-option-save").attr('class') != 'hidden') {
				if ($("#d-day-6").attr('class') == 'clear') {
					$("#d-day-6").attr('class', 'shaded');
				} else {
					$("#d-day-6").attr('class', 'clear');
				}
			}
		});

		$("#d-day-7").on("click", function () {
			if ($("#pref-edit-option-save").attr('class') != 'hidden') {
				if ($("#d-day-7").attr('class') == 'clear') {
					$("#d-day-7").attr('class', 'shaded');
				} else {
					$("#d-day-7").attr('class', 'clear');
				}
			}
		});


	</script>
	<script type="application/javascript">
        jQuery(function() {
        	var userId = MealShareApp.getUserIdFromUrl();
            MealShareApp.getUserDetails(userId);
        });

        jQuery('#avatar-file-input').on('change', function() {
		    if (this.files && this.files[0]) {
		        var fr = new FileReader();
		        fr.addEventListener("load", function(e) {
		            base64 = e.target.result;
		            clean_base64 = base64.split(',')[1];
		            MealShareApp.uploadedImageData = clean_base64;
		        });
		        fr.readAsDataURL(this.files[0])
		    } 
		});

		jQuery('#avatar-file-upload-button').on('click', function() {
		    MealShareApp.uploadImage();
		    jQuery('#avatar-file-input').val('');
		});

		jQuery('#avatar-file-input').val('');

		// Show the upload form only if the user is the current one
		jQuery(function() {
		    var loggedInUser = MealShareApp.getCurrentUserName();
		    var viewedUser = MealShareApp.getUserIdFromUrl();
		    if (loggedInUser == viewedUser) {
		    	jQuery('#pref-edit-option-edit').show();
		    } else {
		    	jQuery('#pref-edit-option-edit').hide();
		    }
		});

		$("#profile-icon").on("click", function() {
        	MealShareApp.goToProfile();
        })

        $("#cal-icon").on("click", function () {
        	MealShareApp.goToCalendar();
        })
    </script>
</body>
</html>
